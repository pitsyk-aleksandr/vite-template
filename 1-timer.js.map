{"version":3,"file":"1-timer.js","sources":["../src/js/1-timer.js"],"sourcesContent":["// Підключення бібліотеки flatpickr :\n// Імпорт, описаний в документації\nimport flatpickr from 'flatpickr';\n// Додатковий імпорт стилів\nimport 'flatpickr/dist/flatpickr.min.css';\n// +++ Локалізація українською мовою\nimport { Ukrainian } from 'flatpickr/dist/l10n/uk.js';\n\n// Підключення бібліотеки iziToast :\n// Імпорт, описаний в документації\nimport iziToast from 'izitoast';\n// Додатковий імпорт стилів\nimport 'izitoast/dist/css/iziToast.min.css';\n\n// Об'єкт параметрів функції flatpickr(selector, options)\nconst options = {\n  allowInput: false,\n  animate: true,\n  enableTime: true,\n  time_24hr: true,\n  defaultDate: new Date(),\n  minuteIncrement: 1,\n  locale: {\n    firstDayOfWeek: 1, // +++ start week on Monday\n  },\n  locale: Ukrainian, // +++ Локалізація українською мовою\n  onClose(selectedDates) {\n    // Вибрані в календарі дата/час - Unix.time\n    const setDateTime = selectedDates[0].getTime();\n    // Поточні дата/час Date.now() - Unix.time\n\n    // Якщо користувач вибрав дату в минулому, покажи window.alert() з текстом \"Please choose a date in the future\" і зроби кнопку «Start» не активною.\n    if (setDateTime < Date.now()) {\n      // alert('Please choose a date in the future');\n      // Опції вікна сповіщення\n      const iziToastSetting = {\n        // theme: 'dark',\n        timeout: 5000,\n        closeOnEscape: true,\n        position: 'center',\n        backgroundColor: '#EF4040',\n        progressBarColor: '#B51B1B',\n        iconUrl: './img/error.svg',\n        // ---iconColor: '',\n        title: 'Error',\n        titleColor: '#ffffff',\n        titleSize: '16',\n        message: 'Please choose a date in the future',\n        messageColor: '#ffffff',\n        messageSize: '16',\n      };\n\n      // Показуємо вікно сповіщення з помилкою\n      iziToast.show(iziToastSetting);\n\n      // Якщо користувач вибрав НЕвалідну дату, кнопка «Start» стає НЕактивною.\n      refs.btnStart.disabled = true;\n      return;\n    }\n    // Якщо користувач вибрав валідну дату, кнопка «Start» стає активною.\n    refs.btnStart.disabled = false;\n    // Змінній вибраної дати даємо обрану дату\n    userSelectedDate = selectedDates[0];\n    console.log('userSelectedDate', userSelectedDate);\n  },\n};\n\n// Об'єкт посилань сторінки :\nconst refs = {\n  inputDateTime: document.querySelector('#datetime-picker'),\n  btnStart: document.querySelector('[data-start]'),\n  txtDays: document.querySelector('[data-days]'),\n  txtHours: document.querySelector('[data-hours]'),\n  txtMinutes: document.querySelector('[data-minutes]'),\n  txtSeconds: document.querySelector('[data-seconds]'),\n};\n\nconsole.log(`inputDateTime`, refs.inputDateTime);\nconsole.log(`btnStart`, refs.btnStart);\nconsole.log(`txtDays`, refs.txtDays);\nconsole.log(`txtHours`, refs.txtHours);\nconsole.log(`txtMinutes`, refs.txtMinutes);\nconsole.log(`txtSeconds`, refs.txtSeconds);\n\n// ================================================================================\n// Функція convertMs, де ms — різниця між кінцевою і поточною датою в мілісекундах.\n// Для підрахунку значень -  Days Minutes Hours Seconds\n// --------------------------------------------------------------------------------\nfunction convertMs(ms) {\n  // Number of milliseconds per unit of time\n  const second = 1000;\n  const minute = second * 60;\n  const hour = minute * 60;\n  const day = hour * 24;\n\n  // Remaining days\n  const days = Math.floor(ms / day);\n  // Remaining hours\n  const hours = Math.floor((ms % day) / hour);\n  // Remaining minutes\n  const minutes = Math.floor(((ms % day) % hour) / minute);\n  // Remaining seconds\n  const seconds = Math.floor((((ms % day) % hour) % minute) / second);\n\n  return { days, hours, minutes, seconds };\n}\n// ================================================================================\n\n// Змінна в якій буде лежати вибрана Data/Time\nlet userSelectedDate;\n// Змінна для ідентифікатора інтервалу\nlet newTimer;\n\n// Запуск календаря - вибору дати та часу під час редагування елемента Input\nconst calendar = flatpickr(refs.inputDateTime, options);\n\n// Слухач події на кнопку Start\nrefs.btnStart.addEventListener('click', onBtnStart);\n\n// Обробник події при кліку на кнопку Start\nfunction onBtnStart(event) {\n  console.log(`userSelectedDate - `, userSelectedDate);\n  // кнопка «Start» стає НЕактивною.\n  refs.btnStart.disabled = true;\n  // Input стає НЕактивним.\n  refs.inputDateTime.disabled = true;\n  // Запускаємо таймер - виклик интервальної функції\n  newTimer = setInterval(startTimer, 1000);\n}\n\nfunction startTimer() {\n  // Різниця між заданим Date/Time та поточним Date/Time (ms)\n  const timeMs = userSelectedDate.getTime() - Date.now();\n  // Якщо час вичерпаний\n  if (timeMs <= 0) {\n    // Обнуляємо значення секунд для таймера на екрані\n    refs.txtSeconds.textContent = addLeadingZero(0);\n    // Зупиняємо віклики інтервальної функції\n    clearInterval(newTimer);\n    // Встановлюємо INPUT - доступним для редагування\n    refs.inputDateTime.disabled = false;\n    return;\n  }\n  // Якщо ще є час, то :\n  // Конвертуємо міллісекунди в day/hours/minutes/seconds\n  const { days, hours, minutes, seconds } = convertMs(timeMs);\n  // Встановлюємо значення кожного span таймера\n  refs.txtDays.textContent = addLeadingZero(days);\n  refs.txtHours.textContent = addLeadingZero(hours);\n  refs.txtMinutes.textContent = addLeadingZero(minutes);\n  refs.txtSeconds.textContent = addLeadingZero(seconds);\n}\n\n// Функція додавання 0 спереду для однозначних чисел\nfunction addLeadingZero(value) {\n  if (value < 100) {\n    return String(value).padStart(2, '0');\n  } else {\n    return String(value);\n  }\n}\n"],"names":["options","Ukrainian","selectedDates","iziToastSetting","iziToast","refs","userSelectedDate","convertMs","ms","days","hours","minutes","seconds","newTimer","flatpickr","onBtnStart","event","startTimer","timeMs","addLeadingZero","value"],"mappings":"iJAeA,MAAMA,EAAU,CACd,WAAY,GACZ,QAAS,GACT,WAAY,GACZ,UAAW,GACX,YAAa,IAAI,KACjB,gBAAiB,EACjB,OAAQ,CACN,eAAgB,CACjB,EACD,OAAQC,EAAS,UACjB,QAAQC,EAAe,CAMrB,GAJoBA,EAAc,CAAC,EAAE,QAAO,EAI1B,KAAK,MAAO,CAG5B,MAAMC,EAAkB,CAEtB,QAAS,IACT,cAAe,GACf,SAAU,SACV,gBAAiB,UACjB,iBAAkB,UAClB,QAAS,kBAET,MAAO,QACP,WAAY,UACZ,UAAW,KACX,QAAS,qCACT,aAAc,UACd,YAAa,IACrB,EAGMC,EAAS,KAAKD,CAAe,EAG7BE,EAAK,SAAS,SAAW,GACzB,MACD,CAEDA,EAAK,SAAS,SAAW,GAEzBC,EAAmBJ,EAAc,CAAC,EAClC,QAAQ,IAAI,mBAAoBI,CAAgB,CACjD,CACH,EAGMD,EAAO,CACX,cAAe,SAAS,cAAc,kBAAkB,EACxD,SAAU,SAAS,cAAc,cAAc,EAC/C,QAAS,SAAS,cAAc,aAAa,EAC7C,SAAU,SAAS,cAAc,cAAc,EAC/C,WAAY,SAAS,cAAc,gBAAgB,EACnD,WAAY,SAAS,cAAc,gBAAgB,CACrD,EAEA,QAAQ,IAAI,gBAAiBA,EAAK,aAAa,EAC/C,QAAQ,IAAI,WAAYA,EAAK,QAAQ,EACrC,QAAQ,IAAI,UAAWA,EAAK,OAAO,EACnC,QAAQ,IAAI,WAAYA,EAAK,QAAQ,EACrC,QAAQ,IAAI,aAAcA,EAAK,UAAU,EACzC,QAAQ,IAAI,aAAcA,EAAK,UAAU,EAMzC,SAASE,EAAUC,EAAI,CAQrB,MAAMC,EAAO,KAAK,MAAMD,EAAK,KAAG,EAE1BE,EAAQ,KAAK,MAAOF,EAAK,MAAO,IAAI,EAEpCG,EAAU,KAAK,MAAQH,EAAK,MAAO,KAAQ,GAAM,EAEjDI,EAAU,KAAK,MAASJ,EAAK,MAAO,KAAQ,IAAU,GAAM,EAElE,MAAO,CAAE,KAAAC,EAAM,MAAAC,EAAO,QAAAC,EAAS,QAAAC,CAAO,CACxC,CAIA,IAAIN,EAEAO,EAGaC,EAAUT,EAAK,cAAeL,CAAO,EAGtDK,EAAK,SAAS,iBAAiB,QAASU,CAAU,EAGlD,SAASA,EAAWC,EAAO,CACzB,QAAQ,IAAI,sBAAuBV,CAAgB,EAEnDD,EAAK,SAAS,SAAW,GAEzBA,EAAK,cAAc,SAAW,GAE9BQ,EAAW,YAAYI,EAAY,GAAI,CACzC,CAEA,SAASA,GAAa,CAEpB,MAAMC,EAASZ,EAAiB,QAAS,EAAG,KAAK,IAAG,EAEpD,GAAIY,GAAU,EAAG,CAEfb,EAAK,WAAW,YAAcc,EAAe,CAAC,EAE9C,cAAcN,CAAQ,EAEtBR,EAAK,cAAc,SAAW,GAC9B,MACD,CAGD,KAAM,CAAE,KAAAI,EAAM,MAAAC,EAAO,QAAAC,EAAS,QAAAC,GAAYL,EAAUW,CAAM,EAE1Db,EAAK,QAAQ,YAAcc,EAAeV,CAAI,EAC9CJ,EAAK,SAAS,YAAcc,EAAeT,CAAK,EAChDL,EAAK,WAAW,YAAcc,EAAeR,CAAO,EACpDN,EAAK,WAAW,YAAcc,EAAeP,CAAO,CACtD,CAGA,SAASO,EAAeC,EAAO,CAC7B,OAAIA,EAAQ,IACH,OAAOA,CAAK,EAAE,SAAS,EAAG,GAAG,EAE7B,OAAOA,CAAK,CAEvB"}